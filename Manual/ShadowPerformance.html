<!DOCTYPE html><html class="no-js" lang="zh-cn">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5V25JL6');
    </script><link href="https://fonts.googleapis.com/css?family=Roboto&amp;display=swap" rel="stylesheet">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="twitter:card" content="summary">
<meta property="og:title" content="阴影故障排除 - Unity 手册">
<title>阴影故障排除 - Unity 手册</title>
<meta property="og:image" content="https://docs.unity3d.com/cn/2020.3/uploads/Main/ShadowBiasAcne.jpg">
<meta name="description" content="实时阴影具有相当高的渲染开销；任何可能投射阴影的游戏对象都必须首先渲染到阴影贴图中，然后该贴图将用于渲染可能接受阴影的对象。">
<meta property="og:description" content="实时阴影具有相当高的渲染开销；任何可能投射阴影的游戏对象都必须首先渲染到阴影贴图中，然后该贴图将用于渲染可能接受阴影的对象。">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="https://unity.com/themes/contrib/unity_base/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" charset="UTF-8" data-domain-script="6e91be4c-3145-4ea2-aa64-89d716064836"></script><script type="text/javascript">
        function OptanonWrapper() { }
    </script><script>
      var docs_type = 'Manual';
      var lang = 'cn';
      var page = 'ShadowPerformance';
      if(!page) page = 'index';
      var version = '2020.3';
      var docs_versions = [{version: '2021.2',version_string: '2021.2',supported: true},{version: '2021.1',version_string: '2021.1',supported: true},{version: '2020.3',version_string: '2020.3',supported: true},{version: '2020.2',version_string: '2020.2',supported: false},{version: '2020.1',version_string: '2020.1',supported: false},{version: '2019.4',version_string: '2019.4',supported: true},{version: '2019.3',version_string: '2019.3',supported: false},{version: '2019.2',version_string: '2019.2',supported: false},{version: '2019.1',version_string: '2019.1',supported: false},{version: '2018.4',version_string: '2018.4',supported: true},{version: '2018.3',version_string: '2018.3',supported: false},{version: '2018.2',version_string: '2018.2',supported: false},{version: '2018.1',version_string: '2018.1',supported: false},{version: '2017.4',version_string: '2017.4',supported: false},{version: '2017.3',version_string: '2017.3',supported: false},{version: '2017.2',version_string: '2017.2',supported: false},{version: '2017.1',version_string: '2017.1',supported: false},{version: '5.6',version_string: '560',supported: false},];</script><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="../StaticFiles/js/core.js"></script><script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src=""></script><script type="text/javascript" src="../StaticFiles/js/custom.js"></script><link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css">
<link rel="canonical" href="https://docs.unity3d.com/cn/2020.3/Manual/ShadowPerformance.html">
<link rel="alternate" href="https://docs.unity3d.com/en/2020.3/Manual/ShadowPerformance.html" hreflang="en">
<link rel="alternate" href="https://docs.unity3d.com/cn/2020.3/Manual/ShadowPerformance.html" hreflang="zh">
<link rel="alternate" href="https://docs.unity3d.com/ja/2020.3/Manual/ShadowPerformance.html" hreflang="ja">
<link rel="alternate" href="https://docs.unity3d.com/es/2020.3/Manual/ShadowPerformance.html" hreflang="es">
<link rel="alternate" href="https://docs.unity3d.com/kr/2020.3/Manual/ShadowPerformance.html" hreflang="ko">
<link rel="alternate" href="https://docs.unity3d.com/ru/2020.3/Manual/ShadowPerformance.html" hreflang="ru">
<link rel="alternate" href="https://docs.unity3d.com/2020.3/Documentation/Manual/ShadowPerformance.html" hreflang="x-default">
</head>
<body>
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="./index.html"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="搜索手册..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul class="menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">
                unity3d.com
              </a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2020.3</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;">
<ul class="versions">
<li class="supported"><a class="docs_version_url_2021.2" href="/cn/2021.2/Manual/ShadowPerformance.html">2021.2</a></li>
<li class="supported"><a class="docs_version_url_2021.1" href="/cn/2021.1/Manual/ShadowPerformance.html">2021.1</a></li>
<li class="supported"><a class="docs_version_url_2020.3" href="/cn/2020.3/Manual/ShadowPerformance.html">2020.3</a></li>
<li class=""><a class="docs_version_url_2020.2" href="/cn/2020.2/Manual/ShadowPerformance.html">2020.2</a></li>
<li class=""><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/ShadowPerformance.html">2020.1</a></li>
<li class="supported"><a class="docs_version_url_2019.4" href="/cn/2019.4/Manual/ShadowPerformance.html">2019.4</a></li>
<li class=""><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/ShadowPerformance.html">2019.3</a></li>
<li class=""><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/ShadowPerformance.html">2019.2</a></li>
<li class=""><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/ShadowPerformance.html">2019.1</a></li>
<li class="supported"><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/ShadowPerformance.html">2018.4</a></li>
<li class=""><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/ShadowPerformance.html">2018.3</a></li>
<li class=""><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/ShadowPerformance.html">2018.2</a></li>
<li class=""><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/ShadowPerformance.html">2018.1</a></li>
<li class=""><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/ShadowPerformance.html">2017.4</a></li>
<li class=""><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/ShadowPerformance.html">2017.3</a></li>
<li class=""><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/ShadowPerformance.html">2017.2</a></li>
<li class=""><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/ShadowPerformance.html">2017.1</a></li>
<li class=""><a class="docs_version_url_560" href="/cn/560/Manual/ShadowPerformance.html">5.6</a></li>
<div class="versionsWithThisPage" style="display:none;"><li><p>包含此页的版本：</p></li></div>
<div class="versionsWithoutThisPage" style="display:none;"><li><p>不含此页的版本：</p></li></div>
</ul>
<ul class="description">
<li>
<div class="supported-box"></div>受支持</li>
<li>
<div class="legacy-box"></div>旧版</li>
</ul>
</div>
</div>
<ul class="nav-menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">语言:
        <span class="b">中文</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a data-lang="en" href="/2020.3/Documentation/Manual/ShadowPerformance.html">English</a></li>
<li><a data-lang="cn" href="/cn/2020.3/Manual/ShadowPerformance.html">中文</a></li>
<li><a data-lang="ja" href="/ja/2020.3/Manual/ShadowPerformance.html">日本語</a></li>
<li><a data-lang="es" href="/es/2020.3/Manual/ShadowPerformance.html">Español</a></li>
<li><a data-lang="kr" href="/kr/2020.3/Manual/ShadowPerformance.html">한국어</a></li>
<li><a data-lang="ru" href="/ru/2020.3/Manual/ShadowPerformance.html">Русский</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar hidden"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc">
<h2>手册</h2>
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2020.3</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;">
<ul class="versions">
<li class="supported"><a class="docs_version_url_2021.2" href="/cn/2021.2/Manual/ShadowPerformance.html">2021.2</a></li>
<li class="supported"><a class="docs_version_url_2021.1" href="/cn/2021.1/Manual/ShadowPerformance.html">2021.1</a></li>
<li class="supported"><a class="docs_version_url_2020.3" href="/cn/2020.3/Manual/ShadowPerformance.html">2020.3</a></li>
<li class=""><a class="docs_version_url_2020.2" href="/cn/2020.2/Manual/ShadowPerformance.html">2020.2</a></li>
<li class=""><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/ShadowPerformance.html">2020.1</a></li>
<li class="supported"><a class="docs_version_url_2019.4" href="/cn/2019.4/Manual/ShadowPerformance.html">2019.4</a></li>
<li class=""><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/ShadowPerformance.html">2019.3</a></li>
<li class=""><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/ShadowPerformance.html">2019.2</a></li>
<li class=""><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/ShadowPerformance.html">2019.1</a></li>
<li class="supported"><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/ShadowPerformance.html">2018.4</a></li>
<li class=""><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/ShadowPerformance.html">2018.3</a></li>
<li class=""><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/ShadowPerformance.html">2018.2</a></li>
<li class=""><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/ShadowPerformance.html">2018.1</a></li>
<li class=""><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/ShadowPerformance.html">2017.4</a></li>
<li class=""><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/ShadowPerformance.html">2017.3</a></li>
<li class=""><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/ShadowPerformance.html">2017.2</a></li>
<li class=""><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/ShadowPerformance.html">2017.1</a></li>
<li class=""><a class="docs_version_url_560" href="/cn/560/Manual/ShadowPerformance.html">5.6</a></li>
<div class="versionsWithThisPage" style="display:none;"><li><p>包含此页的版本：</p></li></div>
<div class="versionsWithoutThisPage" style="display:none;"><li><p>不含此页的版本：</p></li></div>
</ul>
<ul class="description">
<li>
<div class="supported-box"></div>受支持</li>
<li>
<div class="legacy-box"></div>旧版</li>
</ul>
</div>
</div>
<div class="clear"></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap opened-sidebar"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity 用户手册 2020.3 (LTS)</a></li>
<li><a href="Graphics.html">图形</a></li>
<li><a href="LightingOverview.html">光照</a></li>
<li><a href="Shadows.html">阴影</a></li>
<li>阴影故障排除</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="shadow-cascades.html"></a></span><div class="tip">阴影级联</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="lighting-window.html"></a></span><div class="tip">Lighting 窗口</div>
</div>
</div></div>
<h1>阴影故障排除</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<h2>阴影性能</h2>

<p>实时阴影具有相当高的渲染开销；任何可能投射阴影的游戏对象都必须首先渲染到阴影贴图中，然后该贴图将用于渲染可能接受阴影的对象。</p>

<p>Soft shadows have a greater rendering overhead than hard shadows, but this only affects the GPU and does not cause much extra CPU work.</p>

<h2>阴影暗斑</h2>

<p>直接获得光照的表面有时看起来部分处于阴影中。之所以出现这种情况，是因为应该精确位于阴影贴图中指定距离处的像素有时被计算为更远距离（这是对阴影贴图使用阴影过滤或低分辨率图像的结果）。造成的结果是阴影中出现任意像素图案（这些像素其实应当获得光照），带来称为“阴影暗斑”(shadow acne) 的视觉效果。</p>

<figure>
<img src="../uploads/Main/ShadowBiasAcne.jpg" alt="阴影暗斑的出现形式是虚假的自我阴影瑕疵">
<figcaption>阴影暗斑的出现形式是虚假的自我阴影瑕疵</figcaption>
</figure>

<p><a name="LightBias"></a> </p>

<h3>light bias 设置</h3>

<p>为防止阴影暗斑，可以调整 <strong>light bias</strong> 设置。</p>

<p>可以向阴影贴图中的距离添加偏差，以确保边界线上的像素通过比较，也可以沿其法线将几何体稍微嵌入一点。</p>

<p>在内置渲染管线中，启用阴影后，可以通过 <a href="class-Light.html">Light</a> Inspector 窗口中的 <strong>Bias</strong> 和 <strong>Normal Bias</strong> 属性设置这些值。</p>

<p>不要将 <strong>Bias</strong> 值设置得太高，因为游戏对象附近的阴影周围区域有时会被错误地照亮。这会导致阴影脱离游戏对象，使游戏对象看起来好像飘在地面上方。</p>

<figure>
<img src="../uploads/Main/ShadowBiasPeterPanning.jpg" alt="高 Bias 值使阴影与游戏对象看起来是脱离的">
<figcaption>高 <strong>Bias</strong> 值使阴影与游戏对象看起来是“脱离”的</figcaption>
</figure>

<p>同样，将 <strong>Normal Bias</strong> 值设置得太高会使阴影对于游戏对象来说太窄：</p>

<figure>
<img src="../uploads/Main/ShadowBiasTooThin.jpg" alt="高 Normal Bias 值使阴影形状太窄">
<figcaption>高 <strong>Normal Bias</strong> 值使阴影形状太窄</figcaption>
</figure>

<p>In some situations, <strong>Normal Bias</strong> can cause an unwanted effect called “light bleeding”, where light bleeds through from nearby geometry into areas that should be shadowed. A potential solution is to open the GameObject’s <a href="class-MeshRenderer.html">Mesh Renderer</a> and change the <strong>Cast Shadows</strong> property to <strong>Two Sided</strong>. This can sometimes help, although it can be more resource-intensive and increase performance overhead when rendering the Scene.</p>

<p>The bias values for a Light may need tweaking to make sure that unwanted effects don’t occur. It is generally easier to gauge the right value by eye rather than attempting to calculate it.</p>

<figure>
<img src="../uploads/Main/ShadowNearOffsetOk.jpg" alt="矫正阴影">
<figcaption>矫正阴影</figcaption>
</figure>

<h3>阴影平坠</h3>

<p>To further prevent shadow acne we are using a technique known as <strong>Shadow pancaking</strong>. The idea is to reduce the range of the light space used when rendering the shadow map along the light direction. This leads to an increased precision in the shadow map, reducing shadow acne.</p>

<figure>
<img src="../uploads/Main/PancakingIdea.png" alt="显示阴影平坠原理的图形">
<figcaption>显示阴影平坠原理的图形</figcaption>
</figure>

<p>In the above diagram:</p>

<ul>
<li>
<strong>浅蓝圆圈</strong>代表阴影投射物</li>
<li>
<strong>深蓝矩形</strong>代表原始光照空间</li>
<li>
<strong>绿线</strong>代表优化的近平面（排除了在视锥体中不可见的所有阴影投射物）</li>
</ul>

<p>将这些阴影投射物钳制在优化空间的近裁剪面（在顶点着色器中）。请注意，虽然这通常很有效，但对于穿过近裁剪面的大型三角形，这会带来瑕疵：</p>

<figure>
<img src="../uploads/Main/PancakingProblem.png" alt="大三角形问题">
<figcaption>大三角形问题</figcaption>
</figure>

<p>在此情况下，只有蓝色三角形的一个顶点位于近裁剪面背后并被钳制到此处。但是，这会改变三角形的形状，并可能产生不正确的阴影。</p>

<p>您可以从 <a href="class-QualitySettings.html">Quality</a> 窗口中调整 <strong>Shadow Near Plane Offset</strong> 属性以避免发生此问题。这将拉回近裁剪面。但是，如果将此值设置得非常高，最终会引入阴影暗斑，因为它会提高阴影贴图需要在光照方向上覆盖的范围。或者，您也可以细分有问题的阴影投射三角形。</p>

<h2>阴影不显示</h2>

<p>如果您发现一个或多个对象未投射阴影，则应检查以下几点：</p>

<ul>
<li><p>可在 <a href="class-QualitySettings.html">Quality</a> 窗口中彻底禁用实时阴影。确保启用了正确的质量级别并为该设置启用了阴影。</p></li>
<li><p>All <a href="class-MeshRenderer.html">Mesh Renderers</a> in the scene must be set up with their <em>Receive Shadows</em> and <em>Cast Shadows</em> correctly set. Both are enabled by default, but check that they haven’t been disabled unintentionally.</p></li>
<li><p>Only opaque objects cast and receive shadows, so objects using the built-in <a href="shader-TransparentFamily.html">Transparent</a> or Particle shaders will neither cast nor receive. Generally, you can use the <a href="shader-TransparentCutoutFamily.html">Transparent Cutout</a> shaders instead for objects with “gaps” such as fences, vegetation, etc. Custom <a href="Shaders.html">Shaders</a> must be pixel-lit and use the <a href="SL-SubShaderTags.html">Geometry render queue</a>.</p></li>
<li><p>Objects using <strong>VertexLit</strong> shaders can’t receive shadows, but they can cast them.</p></li>
<li><p>如果游戏对象的材质具有“无光照”类型的着色器，Unity 无法为这些游戏对象计算阴影。只有材质的着色器支持光照时，Unity 才能为材质计算阴影。</p></li>
<li><p>In the Built-in Render Pipeline, using the <a href="RenderTech-ForwardRendering.html">Forward rendering path</a>, some shaders allow only the brightest directional light to cast shadows (in particular, this happens with Unity’s legacy built-in shaders from 4.x versions). If you want to have more than one shadow-casting light then you should use the <a href="RenderTech-DeferredShading.html">Deferred Shading</a> rendering path instead. You can enable your own shaders to support “full shadows” by using the <code>fullforwardshadows</code> <a href="SL-SurfaceShaders.html">surface shader</a> directive.</p></li>
</ul>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="shadow-cascades.html"></a></span><div class="tip">阴影级联</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="lighting-window.html"></a></span><div class="tip">Lighting 窗口</div>
</div>
</div>
</div>
<div class="footer-wrapper">
<div class="footer clear">
<div class="copy">Copyright © 2021 Unity Technologies. Publication 2020.3</div>
<div class="menu">
<a href="https://learn.unity.com/">教程</a><a href="https://answers.unity3d.com">社区答案</a><a href="https://support.unity3d.com/hc/en-us">知识库</a><a href="https://forum.unity3d.com">论坛</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div>
<div></div>
</div>
</div></div></div>
</div>
</body>
</html>
